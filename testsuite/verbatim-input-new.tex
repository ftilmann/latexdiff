\documentclass{article}
\usepackage{verbatim}
%\usepackage{sverb}
\usepackage{listings}

\title{Test document for flattening verbatim environments}

\begin{document}
\noindent Some C code through verbatim input:
\verbatiminput{testg.c}
\noindent Starred variant:
\verbatiminput*{testg.c}

% commented out for now as full support for sverb is more complex
%\noindent Through sverb:
%\verbinput{testg.c}

\noindent And through listings without highlighting:
\lstinputlisting{testg.c}

\noindent With syntax highlighting:
\lstinputlisting[language=C]{testg.c}

% But we should not expand expand any commands if they are in a verb command
\verb|\verbatiminput{testg.c}|

\lstinline|\lstinputlisting[language=C]{testg.c}|

\begin{verbatim}
ENV: \verbatiminput{testg.c}
\end{verbatim}

\begin{lstlisting}[language=tex]
ENV: \verbatiminput{testg.c}
\end{lstlisting}


\end{document}


